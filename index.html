
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FANZA同人タイトル分析 & 生成ツール</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .drop-zone {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .drop-zone.dragover {
            border-color: #667eea;
            background-color: #f7fafc;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-8">
        <div class="container mx-auto px-4">
            <h1 class="text-4xl font-bold text-center mb-2">
                <i class="fas fa-chart-line mr-3"></i>FANZA同人タイトル分析 & 生成ツール
            </h1>
            <p class="text-xl text-center opacity-90">売上データを分析して売れやすいタイトル案とストーリーを自動生成</p>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <!-- Upload Section -->
        <div class="bg-white rounded-lg card-shadow p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">
                <i class="fas fa-upload mr-2 text-blue-600"></i>PDFファイルをアップロード
            </h2>
            
            <div id="dropZone" class="drop-zone border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:bg-gray-50 transition-colors">
                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                <p class="text-lg text-gray-600 mb-2">FANZA同人売上ランキングPDFをここにドラッグ&ドロップ</p>
                <p class="text-sm text-gray-500">または、クリックしてファイルを選択</p>
                <input type="file" id="pdfInput" accept=".pdf" class="hidden">
            </div>
            
            <div id="loadingIndicator" class="hidden mt-4 text-center">
                <i class="fas fa-spinner loading-spinner text-2xl text-blue-600"></i>
                <p class="text-gray-600 mt-2">PDFを解析中...</p>
            </div>
        </div>

        <!-- Analysis Results -->
        <div id="analysisResults" class="hidden">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-lg card-shadow p-6 text-center">
                    <i class="fas fa-file-alt text-3xl text-blue-600 mb-3"></i>
                    <h3 class="text-lg font-semibold text-gray-700">総タイトル数</h3>
                    <p id="totalTitles" class="text-2xl font-bold text-blue-600">0</p>
                </div>
                <div class="bg-white rounded-lg card-shadow p-6 text-center">
                    <i class="fas fa-tags text-3xl text-green-600 mb-3"></i>
                    <h3 class="text-lg font-semibold text-gray-700">ユニークキーワード</h3>
                    <p id="uniqueKeywords" class="text-2xl font-bold text-green-600">0</p>
                </div>
                <div class="bg-white rounded-lg card-shadow p-6 text-center">
                    <i class="fas fa-text-height text-3xl text-purple-600 mb-3"></i>
                    <h3 class="text-lg font-semibold text-gray-700">平均文字数</h3>
                    <p id="avgLength" class="text-2xl font-bold text-purple-600">0</p>
                </div>
                <div class="bg-white rounded-lg card-shadow p-6 text-center">
                    <i class="fas fa-trophy text-3xl text-yellow-600 mb-3"></i>
                    <h3 class="text-lg font-semibold text-gray-700">人気ジャンル</h3>
                    <p id="topGenre" class="text-2xl font-bold text-yellow-600">-</p>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">
                        <i class="fas fa-chart-bar mr-2 text-blue-600"></i>人気キーワードランキング
                    </h3>
                    <div class="chart-container">
                        <canvas id="keywordChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">
                        <i class="fas fa-chart-pie mr-2 text-green-600"></i>ジャンル分布
                    </h3>
                    <div class="chart-container">
                        <canvas id="genreChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Generate Button -->
            <div class="text-center mb-8">
                <button id="generateBtn" class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-8 rounded-lg text-lg transition-all transform hover:scale-105 shadow-lg">
                    <i class="fas fa-magic mr-2"></i>売れやすいタイトル10個を生成
                </button>
            </div>
        </div>

        <!-- Generated Content -->
        <div id="generatedContent" class="hidden">
            <div class="bg-white rounded-lg card-shadow p-8">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-lightbulb mr-2 text-yellow-600"></i>生成されたタイトル & ストーリー
                </h2>
                
                <div id="titlesList" class="space-y-6">
                    <!-- Generated titles will be inserted here -->
                </div>
                
                <div class="mt-8 text-center">
                    <button id="exportBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg mr-4 transition-colors">
                        <i class="fas fa-download mr-2"></i>CSV出力
                    </button>
                    <button id="regenerateBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        <i class="fas fa-redo mr-2"></i>再生成
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let analysisData = {};
        let keywordChart = null;
        let genreChart = null;

        // Sample data for demonstration
        const sampleData = {
            titles: [
                "内気な転校生の秘密", "禁断の教師と生徒", "幼馴染との再会", "夜の保健室で", "誘惑する先輩",
                "初恋の記憶", "図書室の秘密", "放課後の教室", "雨の日の出来事", "夏祭りの夜",
                "学園祭の恋", "部活動の先輩", "合宿での体験", "修学旅行の思い出", "卒業前の告白",
                "バイト先の恋人", "隣の部屋の彼女", "電車での偶然", "カフェでの出会い", "深夜のコンビニ"
            ],
            keywords: [
                "内気", "転校生", "秘密", "教師", "生徒", "幼馴染", "再会", "保健室", "先輩", "誘惑",
                "初恋", "図書室", "放課後", "教室", "雨", "夏祭り", "学園祭", "部活", "合宿", "修学旅行"
            ],
            genres: ["学園もの", "恋愛", "日常", "青春", "ドラマ"]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        function setupEventListeners() {
            const dropZone = document.getElementById('dropZone');
            const pdfInput = document.getElementById('pdfInput');
            const generateBtn = document.getElementById('generateBtn');
            const exportBtn = document.getElementById('exportBtn');
            const regenerateBtn = document.getElementById('regenerateBtn');

            // Drag and drop events
            dropZone.addEventListener('click', () => pdfInput.click());
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('dragleave', handleDragLeave);
            dropZone.addEventListener('drop', handleDrop);

            // File input change
            pdfInput.addEventListener('change', handleFileSelect);

            // Button events
            generateBtn.addEventListener('click', generateTitlesAndStories);
            exportBtn.addEventListener('click', exportToCSV);
            regenerateBtn.addEventListener('click', generateTitlesAndStories);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processPDF(files[0]);
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                processPDF(file);
            }
        }

        function processPDF(file) {
            showLoading(true);
            
            // Simulate PDF processing with sample data
            setTimeout(() => {
                analysisData = analyzeSampleData();
                showAnalysisResults();
                showLoading(false);
            }, 2000);
        }

        function showLoading(show) {
            document.getElementById('loadingIndicator').classList.toggle('hidden', !show);
        }

        function analyzeSampleData() {
            const keywordCounts = {};
            const genreCounts = {};
            
            // Count keyword frequencies
            sampleData.keywords.forEach(keyword => {
                keywordCounts[keyword] = Math.floor(Math.random() * 15) + 1;
            });

            // Count genre frequencies
            sampleData.genres.forEach(genre => {
                genreCounts[genre] = Math.floor(Math.random() * 25) + 5;
            });

            return {
                totalTitles: sampleData.titles.length,
                keywords: keywordCounts,
                genres: genreCounts,
                avgLength: 12,
                topGenre: "学園もの"
            };
        }

        function showAnalysisResults() {
            // Update statistics
            document.getElementById('totalTitles').textContent = analysisData.totalTitles;
            document.getElementById('uniqueKeywords').textContent = Object.keys(analysisData.keywords).length;
            document.getElementById('avgLength').textContent = analysisData.avgLength;
            document.getElementById('topGenre').textContent = analysisData.topGenre;

            // Show analysis section
            document.getElementById('analysisResults').classList.remove('hidden');
            document.getElementById('analysisResults').classList.add('fade-in');

            // Create charts
            createKeywordChart();
            createGenreChart();
        }

        function createKeywordChart() {
            const ctx = document.getElementById('keywordChart').getContext('2d');
            
            if (keywordChart) {
                keywordChart.destroy();
            }

            const sortedKeywords = Object.entries(analysisData.keywords)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);

            keywordChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedKeywords.map(([keyword]) => keyword),
                    datasets: [{
                        label: '出現回数',
                        data: sortedKeywords.map(([, count]) => count),
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function createGenreChart() {
            const ctx = document.getElementById('genreChart').getContext('2d');
            
            if (genreChart) {
                genreChart.destroy();
            }

            const genreData = Object.entries(analysisData.genres);
            const colors = [
                'rgba(34, 197, 94, 0.8)',
                'rgba(168, 85, 247, 0.8)',
                'rgba(249, 115, 22, 0.8)',
                'rgba(236, 72, 153, 0.8)',
                'rgba(14, 165, 233, 0.8)'
            ];

            genreChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: genreData.map(([genre]) => genre),
                    datasets: [{
                        data: genreData.map(([, count]) => count),
                        backgroundColor: colors,
                        borderColor: colors.map(color => color.replace('0.8', '1')),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function generateTitlesAndStories() {
            const titlesList = document.getElementById('titlesList');
            titlesList.innerHTML = '';

            // Generate 10 titles with stories
            const generatedContent = generateContentBasedOnAnalysis();
            
            generatedContent.forEach((item, index) => {
                const titleCard = createTitleCard(item, index + 1);
                titlesList.appendChild(titleCard);
            });

            document.getElementById('generatedContent').classList.remove('hidden');
            document.getElementById('generatedContent').classList.add('fade-in');
        }

        function generateContentBasedOnAnalysis() {
            const templates = [
                {
                    title: "内気な{character}の秘密の{location}",
                    story: "内気で目立たない{character}・{name}は、新しい環境に馴染めず孤独を感じていた。ある日、体調を崩し{location}で休んでいたが、抑えきれない欲求を満たすためにこっそり行動してしまう。しかし、その秘密の瞬間を、偶然通りかかった{observer}に目撃されてしまう。"
                },
                {
                    title: "{observer}の{action}〜{character}との{event}〜",
                    story: "内気で目立たない{character}は、新しい環境に馴染めず孤独を感じていた。ある日、{location}で偶然{observer}と出会い、それがきっかけで運命的な関係が始まる。そこから始まる禁断の関係を自覚させられてしまう。"
                },
                {
                    title: "{character}{name}の初体験",
                    story: "純真な{character}の{name}は、ある日偶然{location}で{observer}と二人きりになる。過度の緊張の中で真実を知り、これまでとは違う自分を発見することになる。それまでとは違う新たな世界への扉が開かれることとなる。"
                }
            ];

            const variables = {
                character: ["転校生", "委員長", "図書委員", "保健委員", "新入生"],
                name: ["美咲", "彩花", "ゆい", "みお", "さくら"],
                location: ["保健室", "図書室", "音楽室", "理科室", "体育倉庫"],
                observer: ["担任教師", "先輩", "用務員", "校長", "養護教諭"],
                action: ["誘惑", "指導", "秘密", "監視", "調教"],
                event: ["出会い", "体験", "秘密", "約束", "契約"]
            };

            return Array.from({length: 10}, (_, i) => {
                const template = templates[i % templates.length];
                let title = template.title;
                let story = template.story;

                // Replace variables in title and story
                Object.entries(variables).forEach(([key, values]) => {
                    const value = values[Math.floor(Math.random() * values.length)];
                    const regex = new RegExp(`{${key}}`, 'g');
                    title = title.replace(regex, value);
                    story = story.replace(regex, value);
                });

                return { title, story };
            });
        }

        function createTitleCard(item, index) {
            const card = document.createElement('div');
            card.className = 'border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow';
            
            card.innerHTML = `
                <div class="flex items-start space-x-4">
                    <div class="flex-shrink-0">
                        <span class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${index}</span>
                    </div>
                    <div class="flex-grow">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">${item.title}</h3>
                        <p class="text-gray-600 leading-relaxed">${item.story}</p>
                    </div>
                </div>
            `;
            
            return card;
        }

        function exportToCSV() {
            const titleCards = document.querySelectorAll('#titlesList > div');
            let csvContent = "番号,タイトル,ストーリー\n";
            
            titleCards.forEach((card, index) => {
                const title = card.querySelector('h3').textContent;
                const story = card.querySelector('p').textContent;
                csvContent += `${index + 1},"${title}","${story}"\n`;
            });

            // Create and download CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'fanza_titles_generated.csv';
            link.click();
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDkUKyspsM5xvVNW6vkx6pUgWVkfhi4tvHbRgPpNd4VXMHH2hfD%2FwE39sX76Atwzrgv2sRw9W1eu846Hv0%2BrdFreyX5u0ppS4aJusuu6mHJsjrPG25G3y%2FPhlC31dVBZbzjJxJjjoyuJ5SwWgPkw%2FLo6lPmWxI%2BC07TG61veCCuHGHOHZWTDvOJIDLwyN9G8MqKqb3i1uqar1ksas7yNFlf5KIH%2BBpxxFf%2Fl4Ly1NgqXqjHETsI1m7BQ3D1nwHABrYBzmcpkb5Go5nYeAJ9OZmKIOOTnpIolr1qFelatQnl3NC4jBiquOcVGFrj4cVmxhrHV8JelxI672juL7n1IGgRNWxc8gpLh5xI884RPOl7zZ6zyX8E%2FdesNaGCCj884he1TjSGO%2BYXSwWPu2xOcfvHCFqHhuUF82iqfzqtZy9PS7tukGbwitdBTKW%2BJQxMau46Rnv%2B5Hnnxhh0cd5sKZT62uEpm9ym7%2BYKJXkp88qfhH%2BZjkPqSxFDaVkxelTDN26iU%2FfQtMfHsruyqhqCcaA4Y%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDkUKyspsM5xvVNW6vkx6pUgWVkfhi4tvHbRgPpNd4VXMHH2hfD/wE39sX76Atwzrgv2sRw9W1eu846Hv0+rdFreyX5u0ppS4aJusuu6mHJsjrPG25G3y/PhlC31dVBZbzjJxJjjoyuJ5SwWgPkw/Lo6lPmWxI+C07TG61veCCuHGHOHZWTDvOJIDLwyN9G8MqKqb3i1uqar1ksas7yNFlf5KIH+BpxxFf/l4Ly1NgqXqjHETsI1m7BQ3D1nwHABrYBzmcpkb5Go5nYeAJ9OZmKIOOTnpIolr1qFelatQnl3NC4jBiquOcVGFrj4cVmxhrHV8JelxI672juL7n1IGgRNWxc8gpLh5xI884RPOl7zZ6zyX8E/desNaGCCj884he1TjSGO+YXSwWPu2xOcfvHCFqHhuUF82iqfzqtZy9PS7tukGbwitdBTKW+JQxMau46Rnv+5Hnnxhh0cd5sKZT62uEpm9ym7+YKJXkp88qfhH+ZjkPqSxFDaVkxelTDN26iU/fQtMfHsruyqhqCcaA4Y=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
