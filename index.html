
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FANZA同人タイトル分析 & 生成ツール</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
        * {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .upload-area {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .upload-area.dragover {
            border-color: #667eea;
            background-color: #f7fafc;
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 400px;
        }
        .result-card {
            background: linear-gradient(145deg, #ffffff, #f0f4f8);
            border: 1px solid #e2e8f0;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <h1 class="text-4xl font-bold text-center mb-2">
                <i class="fas fa-chart-line mr-3"></i>FANZA同人タイトル分析 & 生成ツール
            </h1>
            <p class="text-center text-blue-100">売上データから売れやすいタイトルとストーリーを自動生成</p>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <!-- Upload Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8 card-hover">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">
                <i class="fas fa-upload mr-2 text-blue-500"></i>PDFファイルアップロード
            </h2>
            <div id="uploadArea" class="upload-area rounded-lg p-8 text-center cursor-pointer">
                <i class="fas fa-file-pdf text-6xl text-gray-400 mb-4"></i>
                <p class="text-gray-600 mb-2">FANZA同人売上ランキング120位までのPDFファイルをドラッグ&ドロップ</p>
                <p class="text-sm text-gray-500">またはクリックしてファイルを選択</p>
                <input type="file" id="fileInput" accept=".pdf" class="hidden">
            </div>
            <div id="uploadStatus" class="mt-4 hidden">
                <div class="flex items-center justify-center text-blue-600">
                    <i class="fas fa-spinner loading-spinner mr-2"></i>
                    <span>ファイルを処理中...</span>
                </div>
            </div>
        </div>

        <!-- Analysis Results -->
        <div id="analysisSection" class="hidden mb-8">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-chart-bar mr-2 text-green-500"></i>データ分析結果
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <!-- Keyword Frequency Chart -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-gray-700">人気キーワード頻度</h3>
                        <div class="chart-container">
                            <canvas id="keywordChart"></canvas>
                        </div>
                    </div>

                    <!-- Genre Distribution Chart -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-gray-700">ジャンル分布</h3>
                        <div class="chart-container">
                            <canvas id="genreChart"></canvas>
                        </div>
                    </div>

                    <!-- Title Length Distribution -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-gray-700">タイトル文字数分布</h3>
                        <div class="chart-container">
                            <canvas id="lengthChart"></canvas>
                        </div>
                    </div>

                    <!-- Pattern Analysis -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-gray-700">人気パターン分析</h3>
                        <div class="chart-container">
                            <canvas id="patternChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Summary Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <i class="fas fa-file-alt text-2xl text-blue-500 mb-2"></i>
                        <p class="text-sm text-gray-600">総タイトル数</p>
                        <p id="totalTitles" class="text-2xl font-bold text-blue-600">-</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg text-center">
                        <i class="fas fa-tags text-2xl text-green-500 mb-2"></i>
                        <p class="text-sm text-gray-600">ユニークキーワード</p>
                        <p id="uniqueKeywords" class="text-2xl font-bold text-green-600">-</p>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg text-center">
                        <i class="fas fa-ruler text-2xl text-purple-500 mb-2"></i>
                        <p class="text-sm text-gray-600">平均文字数</p>
                        <p id="avgLength" class="text-2xl font-bold text-purple-600">-</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg text-center">
                        <i class="fas fa-star text-2xl text-orange-500 mb-2"></i>
                        <p class="text-sm text-gray-600">トレンドジャンル</p>
                        <p id="trendGenre" class="text-lg font-bold text-orange-600">-</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generate Button -->
        <div id="generateSection" class="hidden mb-8">
            <div class="text-center">
                <button id="generateBtn" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-lg font-bold text-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    <i class="fas fa-magic mr-2"></i>売れやすいタイトル10個を生成
                </button>
            </div>
        </div>

        <!-- Generated Results -->
        <div id="resultsSection" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-lightbulb mr-2 text-yellow-500"></i>生成されたタイトル & ストーリー
                </h2>
                
                <div id="generatedContent" class="space-y-6">
                    <!-- Generated titles and stories will be inserted here -->
                </div>

                <!-- Export Buttons -->
                <div class="mt-8 flex justify-center space-x-4">
                    <button id="exportCSV" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors">
                        <i class="fas fa-download mr-2"></i>CSV出力
                    </button>
                    <button id="exportJSON" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors">
                        <i class="fas fa-download mr-2"></i>JSON出力
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2024 FANZA同人タイトル分析ツール. All rights reserved.</p>
            <p class="text-sm text-gray-400 mt-2">AIによる分析と生成機能を活用したタイトル作成支援ツール</p>
        </div>
    </footer>

    <script>
        // Global variables
        let parsedData = [];
        let analysisResults = {};
        let generatedResults = [];

        // DOM elements
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadStatus = document.getElementById('uploadStatus');
        const analysisSection = document.getElementById('analysisSection');
        const generateSection = document.getElementById('generateSection');
        const resultsSection = document.getElementById('resultsSection');
        const generateBtn = document.getElementById('generateBtn');

        // File upload handling
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);

        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        }

        async function handleFile(file) {
            if (file.type !== 'application/pdf') {
                alert('PDFファイルを選択してください。');
                return;
            }

            uploadStatus.classList.remove('hidden');
            
            try {
                const text = await extractTextFromPDF(file);
                parsedData = parseDataFromText(text);
                analysisResults = analyzeData(parsedData);
                
                displayAnalysisResults();
                uploadStatus.classList.add('hidden');
                analysisSection.classList.remove('hidden');
                generateSection.classList.remove('hidden');
                
            } catch (error) {
                console.error('Error processing file:', error);
                alert('ファイルの処理中にエラーが発生しました。');
                uploadStatus.classList.add('hidden');
            }
        }

        async function extractTextFromPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
            let text = '';
            
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                text += textContent.items.map(item => item.str).join(' ') + '\n';
            }
            
            return text;
        }

        function parseDataFromText(text) {
            const lines = text.split('\n').filter(line => line.trim());
            const titles = [];
            
            // Extract titles (assuming they are the main content lines)
            lines.forEach(line => {
                const trimmed = line.trim();
                if (trimmed && trimmed.length > 3 && trimmed.length < 100) {
                    // Remove ranking numbers and clean up
                    const cleaned = trimmed.replace(/^\d+\.?\s*/, '').replace(/[【】\[\]]/g, '');
                    if (cleaned.length > 3) {
                        titles.push(cleaned);
                    }
                }
            });
            
            return titles.slice(0, 120); // Limit to 120 titles
        }

        function analyzeData(titles) {
            const keywords = extractKeywords(titles);
            const genres = classifyGenres(titles);
            const lengths = titles.map(title => title.length);
            const patterns = analyzePatterns(titles);
            
            return {
                keywords,
                genres,
                lengths,
                patterns,
                totalTitles: titles.length,
                avgLength: Math.round(lengths.reduce((a, b) => a + b, 0) / lengths.length)
            };
        }

        function extractKeywords(titles) {
            const keywordCount = {};
            const commonWords = ['の', 'は', 'が', 'を', 'に', 'で', 'と', 'から', 'まで', 'より', 'して', 'した', 'する', 'される', 'れる'];
            
            titles.forEach(title => {
                // Extract 2-3 character segments
                for (let i = 0; i <= title.length - 2; i++) {
                    const word = title.substring(i, i + 2);
                    if (!commonWords.includes(word) && /[ひらがなカタカナ漢字]/.test(word)) {
                        keywordCount[word] = (keywordCount[word] || 0) + 1;
                    }
                }
            });
            
            // Return top 10 keywords
            return Object.entries(keywordCount)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10)
                .map(([word, count]) => ({word, count}));
        }

        function classifyGenres(titles) {
            const genreKeywords = {
                '学園もの': ['学校', '学園', '制服', '教室', '先生', '生徒', '部活', 'JK', 'JC'],
                'ファンタジー': ['魔法', '勇者', '魔王', '冒険', '異世界', 'エルフ', 'ドラゴン'],
                '恋愛': ['恋', '愛', 'デート', 'カップル', '告白', '結婚', '新婚'],
                'オフィス': ['OL', '会社', 'オフィス', '上司', '部下', '営業', 'サラリーマン'],
                '家族': ['母', '姉', '妹', '娘', '息子', '家族', 'ママ', 'パパ'],
                'その他': []
            };
            
            const genreCount = {};
            Object.keys(genreKeywords).forEach(genre => {
                genreCount[genre] = 0;
            });
            
            titles.forEach(title => {
                let matched = false;
                Object.entries(genreKeywords).forEach(([genre, keywords]) => {
                    if (genre !== 'その他' && keywords.some(keyword => title.includes(keyword))) {
                        genreCount[genre]++;
                        matched = true;
                    }
                });
                if (!matched) {
                    genreCount['その他']++;
                }
            });
            
            return genreCount;
        }

        function analyzePatterns(titles) {
            const patterns = {
                'カギ括弧あり': titles.filter(t => /[「」『』]/.test(t)).length,
                '数字含む': titles.filter(t => /\d/.test(t)).length,
                '感嘆符あり': titles.filter(t => /[！!？?]/.test(t)).length,
                'カタカナ多用': titles.filter(t => (t.match(/[ァ-ヴー]/g) || []).length > 3).length,
                '長いタイトル': titles.filter(t => t.length > 20).length
            };
            
            return patterns;
        }

        function displayAnalysisResults() {
            // Update statistics
            document.getElementById('totalTitles').textContent = analysisResults.totalTitles;
            document.getElementById('uniqueKeywords').textContent = analysisResults.keywords.length;
            document.getElementById('avgLength').textContent = analysisResults.avgLength + '文字';
            
            // Find trend genre
            const trendGenre = Object.entries(analysisResults.genres)
                .sort(([,a], [,b]) => b - a)[0][0];
            document.getElementById('trendGenre').textContent = trendGenre;
            
            // Create charts
            createKeywordChart();
            createGenreChart();
            createLengthChart();
            createPatternChart();
        }

        function createKeywordChart() {
            const ctx = document.getElementById('keywordChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: analysisResults.keywords.map(k => k.word),
                    datasets: [{
                        label: '出現回数',
                        data: analysisResults.keywords.map(k => k.count),
                        backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function createGenreChart() {
            const ctx = document.getElementById('genreChart').getContext('2d');
            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'];
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(analysisResults.genres),
                    datasets: [{
                        data: Object.values(analysisResults.genres),
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createLengthChart() {
            const ctx = document.getElementById('lengthChart').getContext('2d');
            const lengthRanges = {
                '5文字以下': analysisResults.lengths.filter(l => l <= 5).length,
                '6-10文字': analysisResults.lengths.filter(l => l >= 6 && l <= 10).length,
                '11-15文字': analysisResults.lengths.filter(l => l >= 11 && l <= 15).length,
                '16-20文字': analysisResults.lengths.filter(l => l >= 16 && l <= 20).length,
                '21文字以上': analysisResults.lengths.filter(l => l >= 21).length
            };
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(lengthRanges),
                    datasets: [{
                        label: 'タイトル数',
                        data: Object.values(lengthRanges),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function createPatternChart() {
            const ctx = document.getElementById('patternChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: Object.keys(analysisResults.patterns),
                    datasets: [{
                        label: '出現数',
                        data: Object.values(analysisResults.patterns),
                        borderColor: 'rgba(153, 102, 255, 1)',
                        backgroundColor: 'rgba(153, 102, 255, 0.2)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Generate titles and stories
        generateBtn.addEventListener('click', generateTitlesAndStories);

        function generateTitlesAndStories() {
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<i class="fas fa-spinner loading-spinner mr-2"></i>生成中...';
            
            setTimeout(() => {
                generatedResults = createTitlesAndStories();
                displayGeneratedResults();
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-magic mr-2"></i>売れやすいタイトル10個を生成';
                resultsSection.classList.remove('hidden');
            }, 2000);
        }

        function createTitlesAndStories() {
            const topKeywords = analysisResults.keywords.slice(0, 5).map(k => k.word);
            const trendGenre = Object.entries(analysisResults.genres).sort(([,a], [,b]) => b - a)[0][0];
            
            const titleTemplates = [
                '{{keyword1}}な{{keyword2}}の秘密',
                '禁断の{{keyword1}}〜{{keyword2}}との出会い〜',
                '{{keyword1}}{{keyword2}}の初体験',
                '隠れた欲望〜{{keyword1}}の{{keyword2}}〜',
                '{{keyword1}}に堕ちた{{keyword2}}',
                '誘惑の{{keyword1}}〜{{keyword2}}編〜',
                '{{keyword1}}{{keyword2}}の告白',
                '秘密の{{keyword1}}教室〜{{keyword2}}先生と〜',
                '{{keyword1}}な{{keyword2}}の誘い',
                '深夜の{{keyword1}}〜{{keyword2}}の想い〜'
            ];

            const storyTemplates = [
                '内気で目立たない{{character}}は、新しい環境に馴染めず孤独を感じていた。ある日、偶然{{situation}}してしまい、その秘密の瞬間を{{witness}}に目撃されてしまう。そこから始まる禁断の関係とは…',
                '真面目で清楚な{{character}}は、いつも周りから良い子だと思われていた。しかし内側では{{desire}}という秘密の欲望を抱えていた。ある日、{{trigger}}をきっかけに、その欲望が表面化してしまう。',
                '{{character}}は普段は誰にも言えない{{secret}}を抱えていた。ある日、{{location}}で{{event}}が起こり、ついに{{consequence}}してしまう。その後の展開は予想もつかない方向へ…',
                '新任の{{character}}は、職場での人間関係に悩んでいた。そんな中、{{mentor}}から特別な指導を受けることになる。最初は戸惑っていたが、徐々に{{development}}していく自分に気づく。',
                '{{character}}は{{relationship}}との関係に満足していたが、ある日{{disruption}}が起こる。混乱の中で{{revelation}}し、これまでとは全く違う自分を発見することになる。'
            ];

            const characters = ['美咲', '由香', '理沙', '綾', '麻衣', '瑞希', '千尋', '美穂', '恵理', '沙織'];
            const situations = ['体調を崩し', '一人になり', '誘惑に負けて', '好奇心から', '偶然'];
            const witnesses = ['変態教師', '同級生', '上司', 'クラスメート', '先輩'];
            const desires = ['背徳的な快感', '禁断の興味', '秘密の欲求', '隠れた願望', '抑圧された感情'];

            const results = [];
            
            for (let i = 0; i < 10; i++) {
                const template = titleTemplates[i];
                const keyword1 = topKeywords[Math.floor(Math.random() * topKeywords.length)];
                const keyword2 = topKeywords[Math.floor(Math.random() * topKeywords.length)];
                
                const title = template
                    .replace('{{keyword1}}', keyword1)
                    .replace('{{keyword2}}', keyword2);
                
                const storyTemplate = storyTemplates[Math.floor(Math.random() * storyTemplates.length)];
                const character = characters[Math.floor(Math.random() * characters.length)];
                const situation = situations[Math.floor(Math.random() * situations.length)];
                const witness = witnesses[Math.floor(Math.random() * witnesses.length)];
                
                const story = storyTemplate
                    .replace(/{{character}}/g, character)
                    .replace('{{situation}}', situation)
                    .replace('{{witness}}', witness)
                    .replace('{{desire}}', desires[Math.floor(Math.random() * desires.length)])
                    .replace('{{secret}}', '秘密の趣味')
                    .replace('{{location}}', '保健室')
                    .replace('{{event}}', '偶然の出来事')
                    .replace('{{consequence}}', '秘密が暴露')
                    .replace('{{mentor}}', '指導教官')
                    .replace('{{development}}', '変化')
                    .replace('{{relationship}}', '恋人')
                    .replace('{{disruption}}', '予期せぬ事件')
                    .replace('{{revelation}}', '真実を知り')
                    .replace('{{trigger}}', 'ある出来事');
                
                results.push({
                    id: i + 1,
                    title: title,
                    story: story
                });
            }
            
            return results;
        }

        function displayGeneratedResults() {
            const container = document.getElementById('generatedContent');
            container.innerHTML = '';
            
            generatedResults.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card rounded-lg p-6 fade-in';
                resultCard.style.animationDelay = `${index * 0.1}s`;
                
                resultCard.innerHTML = `
                    <div class="flex items-start mb-4">
                        <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4 flex-shrink-0">
                            ${result.id}
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800 mb-3">${result.title}</h3>
                            <p class="text-gray-600 leading-relaxed">${result.story}</p>
                        </div>
                    </div>
                `;
                
                container.appendChild(resultCard);
            });
        }

        // Export functionality
        document.getElementById('exportCSV').addEventListener('click', exportToCSV);
        document.getElementById('exportJSON').addEventListener('click', exportToJSON);

        function exportToCSV() {
            const headers = ['番号', 'タイトル', 'ストーリー'];
            const rows = generatedResults.map(result => [
                result.id,
                `"${result.title}"`,
                `"${result.story}"`
            ]);
            
            const csv = [headers.join(','), ...rows.map(row => row.join(','))].join('\n');
            downloadFile('generated_titles.csv', csv, 'text/csv');
        }

        function exportToJSON() {
            const json = JSON.stringify(generatedResults, null, 2);
            downloadFile('generated_titles.json', json, 'application/json');
        }

        function downloadFile(filename, content, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDg3SLYgzIyp4V8WtJNcgWeHxpXe0qyHSPQAst3UZIS4IgkbVir9ZYDr4DOu0Zh1SbymPFI%2FkFuSf8ZElroaR817DoHvtj2y2XtUdrVEy2BcO8odKLbVRYlAtuQSUaYRzZlujJkEIfvQUOPygmRH%2F61WkS0n%2BRqsHzO4EBGBP42eE2aY6ZFJJeSN8vrwAIfND1UoaBMJuowd4UHXrDPBYYNCGOiWj84VEbGHcRB5rSDk%2B8PUFqpAz6dsmcLTXGhxwp7UCUkGMFqfW6d%2BhdalS0dSQMkI%2FQYtcFF5SUtbJwnvUfxqr3WObfuB01vdlF61qTiSsDGm5w%2FIg2f4UmKDWy2PwWcwnAjzlpZ9yClrbJ9uugArOUmKOxES5LWSf7DTpI4%2BFxLg4tX4iZf7GsRT9vDSs3FLuygDUjY3fYNMcFUj4fSxG26u3gOfh8UhgKlDT5c%2Bq4jxbRRW1TxNAKAlKbQ6en6regzBn6P1DCaFoW5686DbHK1H2wnd4wHpBKgBX2w%3D%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDg3SLYgzIyp4V8WtJNcgWeHxpXe0qyHSPQAst3UZIS4IgkbVir9ZYDr4DOu0Zh1SbymPFI/kFuSf8ZElroaR817DoHvtj2y2XtUdrVEy2BcO8odKLbVRYlAtuQSUaYRzZlujJkEIfvQUOPygmRH/61WkS0n+RqsHzO4EBGBP42eE2aY6ZFJJeSN8vrwAIfND1UoaBMJuowd4UHXrDPBYYNCGOiWj84VEbGHcRB5rSDk+8PUFqpAz6dsmcLTXGhxwp7UCUkGMFqfW6d+hdalS0dSQMkI/QYtcFF5SUtbJwnvUfxqr3WObfuB01vdlF61qTiSsDGm5w/Ig2f4UmKDWy2PwWcwnAjzlpZ9yClrbJ9uugArOUmKOxES5LWSf7DTpI4+FxLg4tX4iZf7GsRT9vDSs3FLuygDUjY3fYNMcFUj4fSxG26u3gOfh8UhgKlDT5c+q4jxbRRW1TxNAKAlKbQ6en6regzBn6P1DCaFoW5686DbHK1H2wnd4wHpBKgBX2w==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
