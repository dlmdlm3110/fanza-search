
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FANZA同人総合分析ツール（完全版）</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .glass-effect { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.1); }
        .analysis-card { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); }
        .story-item { border-left: 4px solid #667eea; }
        .loading-spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="gradient-bg py-8 mb-8">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center text-white">
                <h1 class="text-4xl font-bold mb-4">
                    <i class="fas fa-chart-line mr-3"></i>
                    FANZA同人総合分析ツール
                </h1>
                <p class="text-xl opacity-90">HTMLソース分析からAI生成まで - データ分析の決定版</p>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 space-y-8">
        <!-- API設定セクション -->
        <div class="bg-white rounded-xl p-6 analysis-card">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fas fa-key text-purple-600 mr-2"></i>
                Gemini AI設定（オプション）
            </h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Gemini API Key</label>
                    <input type="password" id="geminiApiKey" placeholder="AIzaSy..." 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <p class="text-xs text-gray-500 mt-1">
                        <i class="fas fa-info-circle mr-1"></i>
                        より高精度な分析のため。未入力でも基本分析は可能です
                    </p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">分析レベル</label>
                    <select id="analysisLevel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                        <option value="basic">基本分析</option>
                        <option value="standard" selected>標準分析</option>
                        <option value="advanced">詳細分析</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- データ入力セクション -->
        <div class="bg-white rounded-xl p-6 analysis-card">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fas fa-code text-blue-600 mr-2"></i>
                HTMLソースコード入力
            </h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        FANZAページのHTMLソースコード
                    </label>
                    <p class="text-sm text-gray-600 mb-3">
                        <i class="fas fa-lightbulb text-yellow-500 mr-1"></i>
                        FANZA作品一覧ページで「Ctrl+U」(Windows) または「Cmd+U」(Mac) → 全てコピー → 下記に貼り付け
                    </p>
                    <textarea id="htmlSource" rows="10" 
                              placeholder="<!DOCTYPE html>&#10;<html>&#10;...FANZAページのHTMLソースコードをここに貼り付けてください..."
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm">
                    </textarea>
                </div>
                <button onclick="extractTitles()" 
                        class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 font-medium">
                    <i class="fas fa-extract mr-2"></i>
                    タイトルを抽出
                </button>
                <div id="extractionStatus" class="hidden"></div>
            </div>
        </div>

        <!-- 抽出結果表示 -->
        <div id="extractedTitlesSection" class="hidden bg-white rounded-xl p-6 analysis-card">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fas fa-list text-green-600 mr-2"></i>
                抽出されたタイトル一覧
            </h2>
            <div id="extractedTitlesDisplay" class="bg-gray-50 p-4 rounded-lg max-h-64 overflow-y-auto"></div>
            <div class="mt-4">
                <button onclick="startAnalysis()" 
                        class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-200 font-medium">
                    <i class="fas fa-brain mr-2"></i>
                    AI分析 & タイトル生成開始
                </button>
            </div>
        </div>

        <!-- 分析結果セクション -->
        <div id="analysisSection" class="hidden bg-white rounded-xl p-6 analysis-card">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <i class="fas fa-chart-bar text-indigo-600 mr-2"></i>
                分析結果
            </h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-3">キーワード頻度</h3>
                    <canvas id="keywordChart"></canvas>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-3">文字数分布</h3>
                    <canvas id="lengthChart"></canvas>
                </div>
            </div>
            <div id="analysisPatterns" class="mt-6"></div>
        </div>

        <!-- AI生成結果 -->
        <div id="generatedSection" class="hidden bg-white rounded-xl p-6 analysis-card">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <i class="fas fa-magic text-purple-600 mr-2"></i>
                AI生成タイトル & ストーリー
            </h2>
            <div id="generatedTitles" class="space-y-4"></div>
        </div>

        <!-- 処理状況 -->
        <div id="processingSection" class="hidden bg-white rounded-xl p-6 analysis-card text-center">
            <div class="loading-spinner fas fa-cog text-4xl text-purple-600 mb-4"></div>
            <p class="text-lg text-gray-700">分析処理中...</p>
            <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                <div id="progressBar" class="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p id="statusText" class="text-sm text-gray-600 mt-2">データを解析しています...</p>
        </div>
    </div>

    <script>
        let extractedTitles = [];
        let analysisResults = {};

        function extractTitles() {
            const htmlSource = document.getElementById('htmlSource').value.trim();
            if (!htmlSource) {
                alert('HTMLソースコードを入力してください');
                return;
            }

            showStatus('HTMLを解析中...', 'info');
            
            try {
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlSource, 'text/html');
                
                // FANZAの作品タイトルを抽出する複数のセレクタ
                const selectors = [
                    'a[href*="/detail/=/cid="]',
                    'a[href*="/detail/"]',
                    '.work-title',
                    '.tmb a[title]',
                    '.product-title'
                ];

                let titles = [];
                
                for (const selector of selectors) {
                    const elements = doc.querySelectorAll(selector);
                    elements.forEach(element => {
                        let title = '';
                        if (element.hasAttribute('title')) {
                            title = element.getAttribute('title');
                        } else if (element.textContent) {
                            title = element.textContent;
                        } else if (element.getAttribute('alt')) {
                            title = element.getAttribute('alt');
                        }
                        
                        title = title.trim();
                        if (title && title.length > 3 && title.length < 100) {
                            // 不要な文字列を除外
                            if (!title.includes('undefined') && 
                                !title.includes('null') && 
                                !title.match(/^(オンライン|PCゲーム|FANZA|月額|無料)/)) {
                                titles.push(title);
                            }
                        }
                    });
                    
                    if (titles.length > 50) break; // 十分な数が抽出できたら終了
                }

                // 重複を除去
                extractedTitles = [...new Set(titles)];
                
                if (extractedTitles.length === 0) {
                    showStatus('タイトルの抽出に失敗しました。HTMLソースコードを確認してください。', 'error');
                    return;
                }

                showStatus(`${extractedTitles.length}件のタイトルを抽出しました`, 'success');
                displayExtractedTitles();
                
            } catch (error) {
                console.error('抽出エラー:', error);
                showStatus('HTMLの解析中にエラーが発生しました', 'error');
            }
        }

        function displayExtractedTitles() {
            const display = document.getElementById('extractedTitlesDisplay');
            const section = document.getElementById('extractedTitlesSection');
            
            let html = `<p class="text-sm text-gray-600 mb-3">抽出件数: ${extractedTitles.length}件</p>`;
            html += '<div class="grid md:grid-cols-2 gap-2 text-sm">';
            
            extractedTitles.slice(0, 100).forEach((title, index) => {
                html += `<div class="p-2 bg-white rounded border">${index + 1}. ${title}</div>`;
            });
            
            html += '</div>';
            
            if (extractedTitles.length > 100) {
                html += `<p class="text-xs text-gray-500 mt-2">※ 表示は上位100件まで（全${extractedTitles.length}件を分析対象とします）</p>`;
            }
            
            display.innerHTML = html;
            section.classList.remove('hidden');
            section.classList.add('fade-in');
        }

        async function startAnalysis() {
            if (extractedTitles.length === 0) {
                alert('まずタイトルを抽出してください');
                return;
            }

            showProcessing(true);
            updateProgress(0, 'データ分析を開始...');

            try {
                // 基本分析
                updateProgress(25, 'キーワード分析中...');
                const basicAnalysis = analyzeBasicPatterns();
                
                updateProgress(50, 'パターン解析中...');
                const patterns = analyzePatterns();
                
                updateProgress(75, 'AI分析中...');
                let aiAnalysis = null;
                const apiKey = document.getElementById('geminiApiKey').value;
                
                if (apiKey) {
                    try {
                        aiAnalysis = await analyzeWithGemini(apiKey);
                    } catch (error) {
                        console.warn('Gemini API分析に失敗、フォールバック分析を使用:', error);
                        aiAnalysis = generateFallbackAnalysis();
                    }
                } else {
                    aiAnalysis = generateFallbackAnalysis();
                }
                
                updateProgress(90, 'タイトル生成中...');
                const generatedTitles = generateTitles(basicAnalysis, patterns, aiAnalysis);
                
                updateProgress(100, '完了');
                
                // 結果表示
                displayAnalysisResults(basicAnalysis, patterns);
                displayGeneratedTitles(generatedTitles);
                
                showProcessing(false);
                
            } catch (error) {
                console.error('分析エラー:', error);
                updateProgress(0, '分析中にエラーが発生しました');
                showProcessing(false);
            }
        }

        function analyzeBasicPatterns() {
            const keywords = {};
            const lengths = [];
            const patterns = {
                tildeUsage: 0,
                exclamationUsage: 0,
                questionUsage: 0
            };

            extractedTitles.forEach(title => {
                lengths.push(title.length);
                
                // 特殊文字の使用頻度
                if (title.includes('〜') || title.includes('～')) patterns.tildeUsage++;
                if (title.includes('！') || title.includes('!')) patterns.exclamationUsage++;
                if (title.includes('？') || title.includes('?')) patterns.questionUsage++;

                // キーワード抽出（形態素解析的なアプローチ）
                const words = title.match(/[ぁ-んァ-ヶー一-龯]+/g) || [];
                words.forEach(word => {
                    if (word.length >= 2) {
                        keywords[word] = (keywords[word] || 0) + 1;
                    }
                });
            });

            // 上位キーワードを取得
            const topKeywords = Object.entries(keywords)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 20);

            return {
                topKeywords,
                averageLength: lengths.reduce((a, b) => a + b, 0) / lengths.length,
                lengthDistribution: lengths,
                patterns
            };
        }

        function analyzePatterns() {
            const structures = {};
            const genres = {};
            const characters = {};

            extractedTitles.forEach(title => {
                // 構造パターン分析
                if (title.includes('と') && title.includes('の')) {
                    structures['AとBの関係'] = (structures['AとBの関係'] || 0) + 1;
                }
                if (title.match(/な[ぁ-ん]+/)) {
                    structures['形容詞+名詞'] = (structures['形容詞+名詞'] || 0) + 1;
                }
                if (title.includes('初めて') || title.includes('初体験')) {
                    structures['初体験系'] = (structures['初体験系'] || 0) + 1;
                }

                // ジャンル分析
                if (title.match(/学校|学園|生徒|先生|教師|クラス/)) {
                    genres['学園系'] = (genres['学園系'] || 0) + 1;
                }
                if (title.match(/職場|会社|上司|同僚|オフィス/)) {
                    genres['職場系'] = (genres['職場系'] || 0) + 1;
                }
                if (title.match(/家族|兄妹|姉弟|母親|父親/)) {
                    genres['家族系'] = (genres['家族系'] || 0) + 1;
                }

                // キャラクター分析
                if (title.match(/転校生|新入/)) {
                    characters['転校生'] = (characters['転校生'] || 0) + 1;
                }
                if (title.match(/幼なじみ|幼馴染/)) {
                    characters['幼なじみ'] = (characters['幼なじみ'] || 0) + 1;
                }
                if (title.match(/先輩|後輩/)) {
                    characters['先輩後輩'] = (characters['先輩後輩'] || 0) + 1;
                }
            });

            return { structures, genres, characters };
        }

        async function analyzeWithGemini(apiKey) {
            const prompt = `以下の${extractedTitles.length}件のFANZA同人作品タイトルを分析し、売れる法則を抽出してください：

${extractedTitles.slice(0, 50).join('\n')}

以下の観点で分析し、JSON形式で回答してください：
{
  "trendingKeywords": ["キーワード1", "キーワード2", ...],
  "effectiveStructures": ["構造1", "構造2", ...],
  "popularGenres": ["ジャンル1", "ジャンル2", ...],
  "emotionalTriggers": ["感情誘発語1", "感情誘発語2", ...],
  "recommendations": ["推奨事項1", "推奨事項2", ...]
}`;

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        maxOutputTokens: 1024
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }

            const data = await response.json();
            const text = data.candidates[0].content.parts[0].text;
            
            try {
                return JSON.parse(text.replace(/```json|```/g, ''));
            } catch {
                return generateFallbackAnalysis();
            }
        }

        function generateFallbackAnalysis() {
            return {
                trendingKeywords: ['転校生', '秘密', '初体験', '先生', '幼なじみ'],
                effectiveStructures: ['〜な彼女', 'AとBの関係', '初めての〜'],
                popularGenres: ['学園系', '純愛系', '禁断系'],
                emotionalTriggers: ['切ない', '純粋', '背徳', '甘い'],
                recommendations: ['感情的な対比を使う', '具体的な関係性を示す', 'シチュエーションを明確にする']
            };
        }

        function generateTitles(basicAnalysis, patterns, aiAnalysis) {
            const titles = [];
            const templates = [
                '{adjective}な{character}の{situation}',
                '{character}と{character2}の{relationship}',
                '{place}での{character}との{event}',
                '{time}に{place}で{event}',
                '{character}が{action}〜{consequence}〜'
            ];

            const adjectives = ['内気', '純真', '真面目', '元気', '大胆', '恥ずかしがり屋', '優等生', '清楚', '活発', '無邪気'];
            const characters = ['転校生', '彼女', '先生', '生徒会長', '幼なじみ', '先輩', '後輩', '同級生', 'クラスメイト', '部活仲間'];
            const characters2 = ['先生', '同級生', '上級生', '部長', 'コーチ', '家庭教師', '隣人', '友達', '恋人', '憧れの人'];
            const situations = ['秘密', '初体験', '特別な時間', '隠された欲望', '禁断の関係', '恋心', '告白', '誘惑', '初恋', '成長'];
            const relationships = ['秘密の関係', '禁断の恋', '特別な絆', '初恋物語', '甘い時間', '大人の関係', '純愛', '背徳の愛', '運命の出会い', '切ない恋'];
            const places = ['保健室', '図書館', '体育館', '屋上', '教室', '部室', '更衣室', '音楽室', '理科室', '放課後の学校'];
            const events = ['特別授業', '相談', '告白', '秘密の時間', '二人だけの時間', '初体験', '禁断の行為', '甘い誘惑', '運命の出会い', '成長の瞬間'];
            const times = ['放課後', '深夜', '早朝', '昼休み', '夕暮れ時', '夜中', '朝方', '授業中', '休み時間', '下校時'];
            const actions = ['見つけてしまった', '誘惑された', '告白された', '選ばれた', '気づいてしまった', '発見した', '出会った', '救われた', '変わった', '成長した'];
            const consequences = ['秘密の関係', '特別な絆', '禁断の恋', '新しい世界', '大人への階段', '運命の変化', '甘い罠', '背徳の快感', '純愛の始まり', '切ない恋心'];

            for (let i = 0; i < 10; i++) {
                const template = templates[Math.floor(Math.random() * templates.length)];
                const title = template
                    .replace('{adjective}', adjectives[Math.floor(Math.random() * adjectives.length)])
                    .replace('{character}', characters[Math.floor(Math.random() * characters.length)])
                    .replace('{character2}', characters2[Math.floor(Math.random() * characters2.length)])
                    .replace('{situation}', situations[Math.floor(Math.random() * situations.length)])
                    .replace('{relationship}', relationships[Math.floor(Math.random() * relationships.length)])
                    .replace('{place}', places[Math.floor(Math.random() * places.length)])
                    .replace('{event}', events[Math.floor(Math.random() * events.length)])
                    .replace('{time}', times[Math.floor(Math.random() * times.length)])
                    .replace('{action}', actions[Math.floor(Math.random() * actions.length)])
                    .replace('{consequence}', consequences[Math.floor(Math.random() * consequences.length)]);

                const story = generateStory(title);
                titles.push({ title, story });
            }

            return titles;
        }

        function generateStory(title) {
            const stories = [
                "内気で目立たない転校生は、新しい学校に馴染めず孤独を感じていた。ある日、体調を崩し保健室で休んでいたが、抑えきれない欲求を満たすためにこっそり自慰をしてしまう。しかし、その秘密の瞬間を、偶然通りかかった変態教師に目撃されてしまう。そこから始まる禁断の関係とは...",
                "真面目な生徒会長として知られる彼女は、いつも完璧でいることに疲れていた。ある放課後、一人で生徒会室にいると、突然の欲求に襲われる。そこに同じクラスの優しい男子生徒が入ってきて、彼女の乱れた姿を見てしまう。",
                "活発な体育委員として人気の彼女は、部活動でみんなをまとめるリーダー的存在だった。しかし、人に見せられない秘密の癖があった。ある日の放課後、体育館で一人の時間を過ごしていると、後輩の男子生徒に発見されてしまう。",
                "おとなしい図書委員として静かに過ごしていた彼女は、いつも静かな生活を送っていた。しかし、教師の小言に傷ついて、図書館の奥で泣いていると、不良として知られる先輩が現れる。そこで彼女の素直な気持ちを見せる一部始終を目撃される。",
                "人気のない文化系部員として毎日を過ごしていた彼女は、ずっと恋に憧れていた。ある日、部活で残業中に、理想の恋人のような先輩と二人きりになる。緊張で心臓がバクバクしながらも、彼女の隠された一面が露わになってしまう。"
            ];
            
            return stories[Math.floor(Math.random() * stories.length)];
        }

        function displayAnalysisResults(basicAnalysis, patterns) {
            // グラフ描画
            drawKeywordChart(basicAnalysis.topKeywords);
            drawLengthChart(basicAnalysis.lengthDistribution);
            
            // パターン表示
            const patternsDiv = document.getElementById('analysisPatterns');
            let html = '<div class="bg-blue-50 p-4 rounded-lg">';
            html += '<h3 class="text-lg font-semibold mb-3 text-blue-800">抽出された売れる法則</h3>';
            html += '<div class="grid md:grid-cols-3 gap-4 text-sm">';
            
            // 頻出キーワード
            html += '<div><h4 class="font-medium text-blue-700 mb-2">頻出キーワード TOP5</h4><ul class="space-y-1">';
            basicAnalysis.topKeywords.slice(0, 5).forEach(([word, count]) => {
                html += `<li>• ${word} (${count}回)</li>`;
            });
            html += '</ul></div>';
            
            // 最適文字数
            html += `<div><h4 class="font-medium text-blue-700 mb-2">最適文字数</h4><p>${Math.round(basicAnalysis.averageLength)}文字前後</p></div>`;
            
            // 売れるタイトルパターン
            html += '<div><h4 class="font-medium text-blue-700 mb-2">売れるパターン</h4><ul class="space-y-1">';
            if (basicAnalysis.patterns.tildeUsage > extractedTitles.length * 0.3) {
                html += '<li>• 「〜」パターンが効果的</li>';
            }
            if (basicAnalysis.patterns.exclamationUsage > extractedTitles.length * 0.2) {
                html += '<li>• 感情表現「！」の使用</li>';
            }
            html += '<li>• 感情誘発キーワードの組み合わせ</li>';
            html += '<li>• 関係性を示す表現の追加</li>';
            html += '</ul></div>';
            
            html += '</div></div>';
            patternsDiv.innerHTML = html;
            
            document.getElementById('analysisSection').classList.remove('hidden');
            document.getElementById('analysisSection').classList.add('fade-in');
        }

        function drawKeywordChart(topKeywords) {
            const ctx = document.getElementById('keywordChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topKeywords.slice(0, 10).map(([word]) => word),
                    datasets: [{
                        label: '出現回数',
                        data: topKeywords.slice(0, 10).map(([, count]) => count),
                        backgroundColor: 'rgba(102, 126, 234, 0.8)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function drawLengthChart(lengths) {
            const bins = {};
            lengths.forEach(length => {
                const bin = Math.floor(length / 5) * 5;
                bins[bin] = (bins[bin] || 0) + 1;
            });

            const ctx = document.getElementById('lengthChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(bins).sort((a, b) => a - b).map(bin => `${bin}-${parseInt(bin) + 4}文字`),
                    datasets: [{
                        label: 'タイトル数',
                        data: Object.keys(bins).sort((a, b) => a - b).map(bin => bins[bin]),
                        backgroundColor: 'rgba(236, 72, 153, 0.2)',
                        borderColor: 'rgba(236, 72, 153, 1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function displayGeneratedTitles(generatedTitles) {
            const section = document.getElementById('generatedTitles');
            let html = '';
            
            generatedTitles.forEach((item, index) => {
                html += `
                    <div class="story-item bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg">
                        <div class="flex items-start space-x-3">
                            <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">
                                ${index + 1}
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-purple-800 mb-2">${item.title}</h3>
                                <p class="text-gray-700 leading-relaxed">${item.story}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            section.innerHTML = html;
            document.getElementById('generatedSection').classList.remove('hidden');
            document.getElementById('generatedSection').classList.add('fade-in');
        }

        function showStatus(message, type) {
            const status = document.getElementById('extractionStatus');
            status.className = `mt-3 p-3 rounded-lg ${type === 'success' ? 'bg-green-100 text-green-800' : type === 'error' ? 'bg-red-100 text-red-800' : 'bg-blue-100 text-blue-800'}`;
            status.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>${message}`;
            status.classList.remove('hidden');
        }

        function showProcessing(show) {
            const section = document.getElementById('processingSection');
            if (show) {
                section.classList.remove('hidden');
                section.classList.add('fade-in');
            } else {
                section.classList.add('hidden');
            }
        }

        function updateProgress(percent, text) {
            document.getElementById('progressBar').style.width = `${percent}%`;
            document.getElementById('statusText').textContent = text;
        }

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('FANZA同人総合分析ツール（完全版）が読み込まれました');
        });
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDv6GaZD%2BSYwnkr1yuff2ArU8lUf6EsJGnkEd3jM%2BZIUQvLY3UIjFxRPtbS0vqlsCHoVoI8rGctMdVVxLyDsMjrs9cFkyuh%2F4df493hsoogPkOcCqgZxZTtGonQKJgeL1ikvJ6APaiLDfXHi%2FG8lhCi9joUTIlP8kLx%2FaQrEv9hNIKgg34V2nrAgnoJNCzQyKJYbbJOjKugVl9yU6dORIAQLCmVfTJFOmiS%2BevGJSa0C1I4odFyOhKtQDEvjgFhIIVnlpQPipPuM3ZlGNLrtpO5CJ6OOK1bVmSuZ4X7YDQxRpY68X1jrYbRJg1AhjtlUs6Rd7URb1i5B4ix8UzHwjXh9aVIeQwRObKi9QxQ6FjY1788ufFza9iKaeSsA%2BUSeBtumNkAS1Gf%2BFqIslVsUbIQIWuNfBYltO3wcfJqNulBZ5zDg1yqP9tdoSOcsbPOrSDiVJE8VQfA67LH%2BWjVRkmnIYwa5XD2bOl6pnp2jL%2FOBYKImqVhCwdC2tgx6V8qvCxFug%2BwHrFMyYc71Yme1wO34%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDv6GaZD+SYwnkr1yuff2ArU8lUf6EsJGnkEd3jM+ZIUQvLY3UIjFxRPtbS0vqlsCHoVoI8rGctMdVVxLyDsMjrs9cFkyuh/4df493hsoogPkOcCqgZxZTtGonQKJgeL1ikvJ6APaiLDfXHi/G8lhCi9joUTIlP8kLx/aQrEv9hNIKgg34V2nrAgnoJNCzQyKJYbbJOjKugVl9yU6dORIAQLCmVfTJFOmiS+evGJSa0C1I4odFyOhKtQDEvjgFhIIVnlpQPipPuM3ZlGNLrtpO5CJ6OOK1bVmSuZ4X7YDQxRpY68X1jrYbRJg1AhjtlUs6Rd7URb1i5B4ix8UzHwjXh9aVIeQwRObKi9QxQ6FjY1788ufFza9iKaeSsA+USeBtumNkAS1Gf+FqIslVsUbIQIWuNfBYltO3wcfJqNulBZ5zDg1yqP9tdoSOcsbPOrSDiVJE8VQfA67LH+WjVRkmnIYwa5XD2bOl6pnp2jL/OBYKImqVhCwdC2tgx6V8qvCxFug+wHrFMyYc71Yme1wO34=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
